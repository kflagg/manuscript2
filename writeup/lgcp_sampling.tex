\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref,amsmath,amsfonts}
\modulolinenumbers[5]

\journal{Spatial Statistics}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
%\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{Log-Gaussian Cox processes and line transect sampling: optimal design critera}

%% Group authors per affiliation:
\author[msuaddr]{Kenneth Flagg\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author}
\ead{kenneth.flagg@montana.edu}

\author[msuaddr]{John Borkowski}
\author[msuaddr]{Andrew Hoegh}

\address[msuaddr]{Department of Mathematical Sciences, Montana State University, Bozeman, MT 59717}

\begin{abstract}

\paragraph{Goal of this paper} Evaluate line-transect designs in terms of many
design-based and model-based criteria for spatial prediction using Bayesian
LGCP models. Identify promising criteria and initial designs for later
optimization and sequential design (not actually optimizing yet). Illuminate
any relationships among criteria that will be helpful for constrained
optimization. Other innovations are to compute design-based criteria with
respect to the path (i.e. as path integrals) and to introduce a model-based APV
criterion with a variable weight that more strongly penalizes errors near a
decision threshold.

\end{abstract}

\begin{keyword}
log-Gaussian Cox process\sep optimal sampling\sep model-based design\sep spatial sampling design
%\MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers

% Can name paragraphs with \paragraph{Title}


\section{Introduction}
% State the objectives of the work and provide an adequate background, avoiding a detailed literature survey or a summary of the results.

Spatial point processes models have long been considered generally infeasible
because of their computational demands, but recent advances in Bayesian
computing have made the Log-Gaussian Cox process an attainable model in
practice \citep{rueetal, lindgrenetal, illianetal, simpsonetal}. Variable
sampling effort leads to a degraded point pattern \cite{chakrabortyetal} and
it is relatively simple to accomodate variable sampling effort in these models
using modern computing tools \citep{yuanetal}. However, the literature on
optimal sampling for spatial point process models is in its infancy
\citep{liuvanhatalo}.
% Note: Liu and Vanhatalo binned the events and used a Laplace approximation,
% not INLA.

Point pattern data are routinely collected in species distribution studies and
ordnance response projects. These applications may use quadrat sampling or
line-transect sampling, with transect sampling being more common. When the
objective is mapping where events occur in space, various spatial mapping
procedures have been used. Traditionally these have involved aggregating the
data to grid cell counts or computing moving averages. These have the downside
of introducing arbitrary structure into the data by the choice of gridding
scheme or averaging window, and require uneccessary computation effort
\citep{simpsonetal}. Software is now available to fit spatial point process
models to data acquired via distance sampling and simultaneously estimate the
detection function \citep{dspat}.

In ecological settings, sampling plans are often designed around the goal of
estimating total abundance. Ordnance response surveys are typically designed
with the objective of detecting (but not necessarily mapping) intensity
hotspots. However, to our knowledge, there has been very little work done in
deciding \emph{where} to collect data when the goal is to map the intensity
using a spatial point process model.


\subsection{Paths as sampling designs}

\citet{liuvanhatalo} used narrow quadrats (swaths along line-transects) as
their sampling units. The transects were short relative to the size of the
study region and not connected into a path.

\citet{pollard} adaptively zigzagged their line transects in a species
abundance survey.

{\it Add relevant VSP references. VSP can create parallel line-transect plans
and add infill based on the actual course-over-ground, but I do not recall what
criteria this may optimize.}

While some ideas about the characteristics of a good point design apply to
paths, creating an optimal path design is not as simple as connecting the
points of a point design with line segments. There are many ways to connect
points into a path, so optimal design criteria must apply to the whole path and
not only to the waypoints.


\subsection{Design-based sampling}

Most work done for points. (Or quadrats approximated as points?) Space-filling
criteria may be good starting points (e.g nearest-neighbor distance).

{\it Not using space-filling point desings? (i.e. designs that have nonzero
area as sample size goes to infinity)}


\subsection{Space-filling curves}

Used in circuit design~\citep{fanetal} ({\it find more citations}) and
high-dimensional data visualization in bioinformatics~\citep{hilbertvis}.
Peano curve is very flexible for filling irregular shapes~\citep{fanetal}.
Hilbert curve is easy to construct.

Space-filling curves are one-dimensional paths constructed iteratively; as the
number of iterations goes to infinity, the limiting path has nonzero area and
actually fills the space~\citep{sagan}. For applications we stop after a finite
number of iterations.


\subsection{Model-based spatial design}

Regularity is optimal for spatial prediction but randomness and a variety of
interpoint distances are best for parameter estimation~\citep{diggle}.
Inhibitory plus close pairs is a good compromise~\citep{chipetaetal2017}.


\subsection{Multi-objective optimization}

summarize \citet{lark} and related

we use a large suite of criteria to explore the relationships among them


\subsection{Notation and Terminology}

\begin{itemize}

\item need to add notation for paths!

\item process defined on \(\mathcal{D} \subset \mathbb{R}^{2}\), domain of the
intensity function, define \(d = \mathrm{dim}(\mathcal{D})\)

\item observation window \(\mathcal{S} \subset \mathcal{D}\)

\item define three regions:
\begin{itemize}
\item the domain \(\mathcal{D}\) over which the process mathematically operates
\item the study region \(\mathcal{R}\) over which inferences are desired
\item the observed/sampled observation window \(\mathcal{S}\)
\end{itemize}

\item general relationship is \(\mathcal{S} \subset \mathcal{R}
\subset \mathcal{D} \subset \mathbb{R}^{d}\) where all of the subset symbols
taken to mean ``subset or equal''

\item \(\mathcal{D}\) can be unbounded or bounded (often \(\mathbb{R}^{d}\)),
$\mathcal{S}$ practically always bounded, \(\mathcal{R}\) bounded or unbounded
depending on application and inferential goals

\item the ``fully surveyed'' situation is \(\mathcal{S} = \mathcal{R}\)

\item \(\mathbf{X}\) point process on \(\mathcal{R}\), \(\mathbf{x} = \{x_{1},
\dots, x_{n}\}\) realized point pattern

\item point \(x \in \mathbf{x}\) called an event

\item intensity function \(\lambda(u)\)

\item types of ``points'' in space:
\begin{itemize}
\item \(x\) event in the point pattern
\item \(s\) numerical integration node
\item \(u\) arbitrary location in \(\mathcal{D}\) used to index intensity
function and predictors
\end{itemize}

\item \(z(u)\) a column vector of covariates/predictors at \(u\)

\item ``point'' refers to a \(u\) unless clearly stated otherwise

\item bold for sets and spatial processes, normal italics for spatial vectors

\item \(y\) and variations will be used for objects derived from the point
pattern, e.g. marks, pseudodata

\end{itemize}


\section{Material and methods}
% Provide sufficient details to allow the work to be reproduced by an independent researcher. Methods that are already published should be summarized, and indicated by a reference. If quoting directly from a previously published method, use quotation marks and also cite the source. Any modifications to existing methods should also be described.


Heuristics of a good transect design:
\begin{itemize}
\item Should start with a sparse design with regular spacing, then refine with
infill
\begin{itemize}
\item Provides good spatial coverage even if aborted early
\item Imagine downloading a high-resolution intensity jpeg over 56k
\end{itemize}
\item Path should avoid sharp turns but is allowed to cross itself
\item One option is to generate two segments at a time, first a short-to-medium
length segment to get to the start of the next transect, then a  medium-to-long
segment for the transect
\item Could have new segment length be negatively correlated with the previous
segment length
\end{itemize}


\subsection{Design-Based Criteria}

\paragraph{Path length}
The total distance that traveled is often a constraint. Minimize it.

\paragraph{Nearest neighbor distance}
A common criterion for space-filling designs, we adapt it to be meaningfully
calculated for any point on a path. Define
\(\mathrm{nnd}_{k}(u) = \min|u - v|\) where \(v\) is any point in the set of
path segments at least \(k\) steps away from the segment containing \(u\). If
\(k = 0\), this includes \(v\) in the same segment as \(u\) so trivially
\(\mathrm{nnd}_{0}(u) = 0\) for all \(u\) in the path. \(\mathrm{nnd}_{1}(u)\)
includes all segments except the one containing \(u\). \(\mathrm{nnd}_{2}(u)\)
excludes the segment containing \(u\) and segments with which it shares
vertices. Segments not accessible by a connected path starting at \(u\) are
always included. Maximize \(\min[\mathrm{nnd}_{2}(u)]\),
\(\mathrm{avg}[\mathrm{nnd}_{2}(u)]\), and
\(\mathrm{avg}[\mathrm{nnd}_{1}(u)]\).


\subsection{Model-Based Criteria}

\paragraph{Posterior prediction variance}
Minimize maximum prediction variance and average prediction variance for GP.

\paragraph{Posterior parameter variance}
Minimize posterior variance for each model parameter (intercept, variance,
spatial scale).

\paragraph{Decision-based criteria}
Maximize error rates and AUC of thresholding the intensity at an action level.
Minimize the threshold-penalized average predictive variance (TPAPV),
\begin{equation*}
\mathrm{TPAPV} = \int_{\mathcal{R}} \mathrm{Var}\left[\lambda(u)\right]
p^{\left|\lambda(u)-A\right|} \mathrm{d}u,
\end{equation*}
where \(A\) is the action level/decision threshold and \(0 < p < 1\) penalizes
uncertainty about the boundary in used for thresholding.


\subsection{Sampling Situations}

\begin{itemize}

\item SRS of parallel transects

\item systematic sample of parallel transects

\item inhibitory plus close pairs of parallel transects

\item random Latin hypercube design connected by shortest path (look at
\texttt{lhs} package)

\item fractal curves with random starting points

\item movement model
\begin{itemize}
\item generate sequentially, two waypoints at a time
\item generate a jump distance and a direction
\item distance negatively correlated with previous distance (should
approximately alternate between a short ``transition'' and a long ``transect'')
\item direction bimodal with modes near \(\pm \pi / 2\)
\item if using location/scale beta for direction, allow any direction when the
support 
\end{itemize}

\end{itemize}

set up to think about adaptive sampling (adding a transect at a time or
stopping early but don't actually do it here)

%\section{Theory/calculation}
% A Theory section should extend, not repeat, the background to the article already dealt with in the Introduction and lay the foundation for further work. In contrast, a Calculation section represents a practical development from a theoretical basis.



\section{Results}
% Results should be clear and concise.

look at examples of designs that minimize each criterion

look at examples of designs along the Pareto front


\section{Discussion}
% This should explore the significance of the results of the work, not repeat them. A combined Results and Discussion section is often appropriate. Avoid extensive citations and discussion of published literature.

discuss starting points for optimization and sequential design


\section{Conclusions}
% The main conclusions of the study may be presented in a short Conclusions section, which may stand alone or form a subsection of a Discussion or Results and Discussion section.



\section*{References}

\bibliography{lgcp_sampling.bib}

\end{document}
