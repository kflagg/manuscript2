\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref,amsmath,amsfonts,subcaption}
\modulolinenumbers[5]

\journal{Spatial Statistics}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
%\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{Spatial Log-Gaussian Cox process models and sampling paths: towards optimal design}

%% Group authors per affiliation:
\author[msuaddr]{Kenneth Flagg\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author}
\ead{kenneth.flagg@montana.edu}

\author[msuaddr]{John Borkowski}
\author[msuaddr]{Andrew Hoegh}

\address[msuaddr]{Department of Mathematical Sciences, Montana State University, Bozeman, MT 59717}

\begin{abstract}

\paragraph{Goal of this paper (placeholder abstract---add some results when
available)} Evaluate a wide variety of path designs in terms design-based
heuristics and model-based criteria for spatial prediction using Bayesian LGCP
models. Identify promising path designs. Illuminate any relationships among
design characteristics and predictive criteria that will be helpful for
constrained optimization.

\end{abstract}

\begin{keyword}
log-Gaussian Cox process\sep optimal sampling\sep model-based design\sep spatial sampling design
%\MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers

% Can name paragraphs with \paragraph{Title}


\section{Introduction}
% State the objectives of the work and provide an adequate background, avoiding a detailed literature survey or a summary of the results.

Spatial point process models have generally been infeasible because of their
computational demands, but recent advances in Bayesian computing have made the
Log-Gaussian Cox process (LGCP) an attainable model in
practice~\citep{rueetal, lindgrenetal, illianetal, simpsonetal}. These advances
make it possible to fit LGCP models easily, without time-consuming Monte Carlo
methods. In some applications, the entire point pattern is not fully observed
due to variable sampling effort. This is referred to as a degraded point
pattern~\citep{chakrabortyetal} and it is relatively simple to accommodate
variable sampling effort in these models using modern Bayesian computing
tools~\citep{yuanetal}. However, the literature on optimal sampling for spatial
point process models is in its infancy~\citep{liuvanhatalo}.

Point pattern data are routinely collected in species distribution studies and
ordnance response projects. The data consist of the locations of events in some
spatial region. These applications may use quadrat sampling or line-transect
sampling, with transect sampling being more common. When the objective is to
map where events occur in space, various spatial mapping procedures have been
used. Traditionally these have involved aggregating the data to grid cell
counts or computing moving averages. Aggregation has the downside of
introducing arbitrary structure into the data by the choice of grid scheme
or averaging window, and requires unnecessary computation
effort~\citep{simpsonetal}. Software is now available to fit spatial point
process models to data acquired via distance sampling and simultaneously
estimate the detection function~\citep{dspat,baser}.
% Recent example of aggregation: https://link-springer-com.proxybz.lib.montana.edu/content/pdf/10.1007/s13253-020-00386-3.pdf

In ecological settings, sampling plans are often designed around the goal of
estimating total abundance. Ordnance response surveys are typically designed
to provide enough data to detect (but not necessarily map) intensity
hotspots~\citep{em200-1-15,flaggetal}. However, to our knowledge, there has
been very little work done in deciding \emph{where} to collect data when the
goal is to map the intensity using a spatial point process model. While some
ideas about the characteristics of a good point design apply to paths, creating
an optimal path design is not as simple as connecting the points of a point
design with line segments. There are many ways to connect points into a path,
so optimal design criteria must apply to the whole path and not only to the
waypoints. In this paper, we present a variety of sampling path designs and
assess their optimality for mapping intensity using LGCP models.


\subsection{Log-Gaussian Cox process}

The log-Gaussian Cox process is an inhomogeneous Poisson process where the
logarithm of the intensity function is a Gaussian process \citep{moelleretal}.
The LGCP provides a flexible model for mapping event intensity over space using
few parameters. Efficient Bayesian computation tools are available using INLA
to approximate the posterior marginal distributions \cite{rueetal}, a finite
element approach to represent the Gaussian process \cite{lindgrenetal}, and
pseudodata to approximate the point process likelihood \cite{simpsonetal}.
% Add some example applications.


\subsection{Spatial design}

Most classical sampling and design work has been done for points, or for small
quadrats approximated as points, rather than for paths. In two-dimensional
(geostatistical) model-based design, regularity is optimal for spatial
prediction but randomness and a variety of interpoint distances are best for
parameter estimation~\citep{diggle}. Inhibitory plus close pairs designs are a
good compromise~\citep{chipetaetal2017}. Design-based approaches exist to
spread points through high-dimensional design spaces~\citep{borkowskipiepel},
and Latin hypercube sampling has space-filling
characteristics~\citep{mckayetal,husslageetal}.


\subsection{Space-filling curves}

Another relevant area of research is in deterministic space-filling curves.
These have used in the design of dense or stretchable
circuits~\citep{ogorzalek,mazhang} and high-dimensional data visualization
in bioinformatics~\citep{hilbertvis}. The Hilbert curve is simple to construct
and the Peano curve is very flexible for filling irregular
shapes~\citep{fanetal}. Space-filling curves are one-dimensional paths
constructed iteratively; as the number of iterations goes to infinity, the
limiting path has nonzero area and actually fills the space~\citep{sagan}. For
applications we stop after a finite number of iterations.


\subsection{Paths as sampling designs}

The small body of literature on spatial sampling design for point pattern
data has focused on line transects. \citet{pollard} began with line transects
and adaptively added zigzags in a species abundance survey.

The Visual Sample Plan software includes features to create systematic transect
plans and augment plans with additional transects in regions lacking spatial
coverage~\citep{vspguide}. It helps the user choose the transect spacing to
maximize the probability of detecting the presence of a hotspot of specified
size and intensity. However, it does not employ criteria to optimize spatial
prediction.

\citet{liuvanhatalo} provided one of the first explicit discussions of design
in the context of spatial LGCP models. They used narrow quadrats (swaths along
line-transects) as their sampling units. The transects were short relative to
the size of the study region and not connected into a path.


%\subsection{Multi-objective optimization}

%summarize \citet{lark} and related

%we can use a large suite of criteria to explore the relationships among them

% (Don't need for this paper.)


\section{Materials and methods}
% Provide sufficient details to allow the work to be reproduced by an independent researcher. Methods that are already published should be summarized, and indicated by a reference. If quoting directly from a previously published method, use quotation marks and also cite the source. Any modifications to existing methods should also be described.

%Kenny's heuristics of a good path design:
%\begin{itemize}
%\item Should start with a sparse design with regular spacing, then refine with
%infill
%\begin{itemize}
%\item Provides good spatial coverage even if aborted early
%\item Imagine downloading a high-resolution intensity jpeg over 56k
%\end{itemize}
%\item Path should avoid sharp turns but is allowed to cross itself
%\item One option is to generate two segments at a time, first a short-to-medium
%length segment to get to the start of the next transect, then a  medium-to-long
%segment for the transect
%\item Could have new segment length be negatively correlated with the previous
%segment length
%\end{itemize}

% Andy's words:
With an eye toward practical considerations of data collection, we present
criteria to compare sampling strategies that impact LGCP estimates. We compare
plans with (approximately) fixed path lengths, most of which avoid sharp turns.
Data collection equipment (e.g. metal detectors) may have limited mobility,
requiring minimizing the number or angle of turns. The criteria that we
evaluate are the mean squared prediction error (MSPE) of the latent Gaussian,
process, the average prediction variance (APV), and the estimation error in the
posterior mean of the intercept.


\subsection{Sampling design schemes}
\label{methodschemes}

In this section, we present three variations of parallel line transect designs
and three schemes that produce more complex designs. To clarify terminology, a
\emph{path} or \emph{design} is a realized set of one or more connected
components that has length but not area. The paths considered in this work are
constructed as sequences of line segments. A \emph{design scheme}, or simply
\emph{scheme}, is procedure for generating designs with some shared
characteristics. Figure~\ref{plancomparison} illustrates a selection of designs
from these schemes.


\subsubsection{Parallel line transects}

Parallel straight-line transects are common in ordnance response studies and in
ecological studies using distance sampling. Systematic designs are common
because they provide good spatial coverage in the sense that any point in the
study region has an a priori known maximum distance from the path. For point
designs, systematic designs are optimal for prediction, simple random samples
are optimal for estimation, and inhibitory with close pairs designs are
becoming a popular compromise. We adapt all of these to the parallel line
transect setting. We use line transects running north-south, with three methods
of choosing the horizontal coordinate: simple random sample (SRS), systematic
with a random starting point and even spacing, and inhibitory plus close pairs.
Figure~\ref{plancomparison} (left column) shows an example of each scheme with
25 transects.

%We should note that we will be using an isotropic covariance function in
%the model. If an anisotropic model is used, parallel transects may need to be
%augmented with perpendicular transects so that the observed data provide the
%full range of pairwise distances in other directions.

\begin{figure}

\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/SRS000176.pdf}
\caption{SRS of 25 parallel transects}
\label{srs000176}
\end{subfigure}
\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Serp000124.pdf}
\caption{Serpentine design with fewer corners}
\label{serp000124}
\end{subfigure}

\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Sys000141.pdf}
\caption{Systematic design of 25 parallel transects}
\label{sys000141}
\end{subfigure}
\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Serp000539.pdf}
\caption{Serpentine design with more corners}
\label{serp000539}
\end{subfigure}

\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Inhib000171.pdf}
\caption{Inhibitory/pairs design with 25 transects}
\label{inhib000171}
\end{subfigure}
\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Hilbert000180.pdf}
\caption{Space-filling Hilbert design, less refined}
\label{hilbert000180}
\end{subfigure}

\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/LHS-TSP000161.pdf}
\caption{Shortest path through a LHS design}
\label{lhstsp000161}
\end{subfigure}
\begin{subfigure}{2.5in}
\includegraphics[width=2.5in]{../graphics/Hilbert000237.pdf}
\caption{Space-filling, Hilbert design, more refined}
\label{hilbert000237}
\end{subfigure}

\caption{Examples of plans from six design schemes. Except for the Hilbert
curve of order 5, all of these plans have approximately the same total length.}
\label{plancomparison}
\end{figure}


\subsubsection{Parallel serpentine transects}

One simple way to observe a greater variety of locations and different
directions is to add lateral ``zigzags'' to transects. We include alternate
right and left turns at right angles to create serpentine transects. This could
decrease prediction variance because more of the path will be close to each
point in the study area than would be under a line transect design with similar
total distance. They will also improve estimation of the covariance function
in the presence of anisotropy. Figure~\ref{plancomparison}, top right, shows
two examples.
% Note: Serp has higher average and max distance from path than Sys but lower
% than SRS and Inhib.

% What to do with the comments about anisotropy? Consolidate them and put them
% in one spot? Anisotropic models are rarely used (underused) and we are
% simulating from isotropic models, but "go in more than one direction if you
% have anisotropic data" is advice worth spending a paragraph on.


\subsubsection{Latin hypercube sampling}

Random Latin hypercube sampling (LHS) produces a design that spreads discrete
points through a (potentially high-dimensional) design space, ensuring that
the full range of each dimension is included while remaining balanced and
keeping the number of points small~\citep{mckayetal}. This is done by
partitioning each dimension into a specified number \(k\) of intervals (thus
stratifying a \(d\)-dimensional design space into \(k^{d}\) cells), selecting
a Latin hypercube design to determine which \(k\) cells will contain a design
point, and then drawing each design point from a uniform distribution over its
cell. In two dimensions, this scheme produces point designs with good spatial
coverage properties. We use the LHS design as waypoints for a path. Because
longer distance typically brings increased costs, we treat this as a traveling
salesperson problem (TSP) and use the shortest path through the waypoints as
our design. This LHS-TSP scheme produces paths that have many sharp corners but
leaves few large voids (example in Figure~\ref{plancomparison}, bottom left). A
downside of this design scheme is that the length cannot be specified directly,
and only certain distances are possible depending on the number of bins used.

Waypoints are generated by the \texttt{lhs} R package~\cite{lhs}
and connected into a the shortest path by the \texttt{TSP} package~\citep{tsp}.


\subsubsection{Space-filling curves}

As a representative of space-filling curves, we use the Hilbert curve scaled
to fit the study site. These designs have many short segments meeting at right
angles. The only parameter of this design scheme is the order, or number of
iterations used in refining the curve. Each iteration increases the length and
complexity of the design. This is produces a deterministic design, so a random
offset is added to vary which points are observed. The Hilbert curve is
generated by \texttt{HilbertVis} R package~\citep{hilbertvis}.

%\paragraph{Particle movement model}
%Models the way data are actually collected. Waypoints generated sequentially by
%generating a jump distance and a direction. The jump distance is generated from
%a scaled beta distribution, and negatively correlated with previous jump
%distance. This behavior should approximately alternate between a short
%``transition'' and a long transect. The negative correlation was achieved by
%applying a \(1 - x\) transformation to a beta autoregressive
%process~\citep{mckenzie}. The direction angle is drawn from a bimodal
%distribution that is symmetric around 0 (a normal distribution reflectd about
%0). {\it explain the Strauss part}

%{\it set up to think about adaptive sampling (adding a transect at a time or
%stopping early but don't actually do it here)}


\subsection{Model fitting}

We fit the spatial LGCP model using nested integrated Laplace approximations
and the R-INLA package~\citep{rueetal,rinla}. The Gaussian process is
approximated using a finite element approach \citep{lindgrenetal}. The point
pattern is modeled by pseudodata placed at the events and the finite element
nodes~\citep{simpsonetal}. This procedure allows fast and accurate
approximation of the posterior distribution.%~\citep{flagghoegh}.


\section{Simulation Study}

We simulate 100 designs from each of six schemes. All events within a 2 unit
radius of the path are observed. The whole experiment is repeated for 5
realizations from each of two data generating models.


\subsection{Study site}

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-LGCP000004.pdf}
\caption{Realized LGCP log-intensity}
\label{lambdalgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-Cluster000004.pdf}
\caption{Realized LGCP with Clusters log-intensity}
\label{lambdacluster}
\end{subfigure}

\caption{The realized intensity function (natural log scale) and complete
point pattern from a LGCP, and from a LGCP superposed with a cluster process.}
\label{fulldata}
\end{figure}

We consider a fictitious site \(\mathcal{R}\) with the simple shape of a 1500
unit by 700 unit rectangle. In this site, we simulate two data generating
models that produce random intensity functions with hotspots. First, a LGCP
with latent GP mean \(\mu = \log(250 / |\mathcal{R}|) = -8.34\) and
Mat\'{e}rn covariance function with \(\nu = 1\), \(\sigma = 2\), and
\(\text{range} = 200\). This model produces relatively unstructured hotspots
due to large variability in the GP. Figure \ref{lambdalgcp} shows an example
realization from this process.

Second, a two-stage cluster process and a LGCP are superposed. The cluster
process (a Neyman-Scott or, more specifically, a Thomas process) is constructed
as follows. The number of clusters is Poisson-distributed with mean 3. The
number of events per cluster is Poisson-distributed with mean 200. The cluster
centers are distributed uniformly over \(\mathcal{R}\). Events come from a
bivariate normal distribution with mean equal to the cluster center and
variance \(\boldsymbol{\Sigma} = \tau^{2}\mathbf{I}\), \(\tau = 50\). The LGCP
component has \(\mu = \log(250 / |\mathcal{R}|) = -8.34\) and Mat\'{e}rn
covariance with \(\nu = 1\), \(\sigma = 1\), and \(\text{range} = 200\). This
model is based upon the typical conceptual model of a firing range, with a
background process (represented by the LGCP) and a small number of
higher-intensity foreground clusters containing the events of interest
(example in Figure \ref{lambdacluster}). As a shorthand, we refer to this
generative process as LGCP with Clusters.

The LGCP generating process matches the model we fit to the realized data. The
model should both produce accurate predictions and have low bias in the
posterior means of the parameters. On the other hand, the parameters of the
LGCP with Clusters process will not correspond to the LGCP model parameters,
but we anticipate that in general the latent GP in the LGCP model will still
accurately predict the log-intensity function.


\subsection{Path design schemes}

\begin{table}
\caption{Design schemes used in the simulation study. The table presents the
design parameters, distance travelled along the path, and percent of the study
area surveyed under each of four survey effort levels.\\
* Variable area due to overlapping segments, reported as average (SD).\\
** Variable distance surveyed, reported as average (SD).}
\label{designtable}
\tiny
\begin{tabular}{|l|c|c|c|c|}
\hline
Scheme
&
Low Effort
&
Medium Effort
&
High Effort
&
Very High Effort
\\
\hline
SRS
&
10 transects
&
25 transects
&
50 transects
&
70 transects
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.65\% (0.0618\%)*
&
6.46\% (0.202\%)*
&
12.5\% (0.331\%)*
&
17.2\% (0.459\%)*
\\
\hline
Systematic
&
10 transects
&
25 transects
&
50 transects
&
70 transects
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.68\%
&
6.70\%
&
13.4\%
&
18.7\%
\\
\hline
Inhibitory,
&
9 transects
&
23 transects
&
45 transects
&
63 transects
\\
10\% Close Pairs
&
1 paired
&
2 paired
&
5 paired
&
7 paired
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.66\% (0.0582\%)*
&
6.53\% (0.172\%)*
&
12.8\% (0.314\%)*
&
17.5\% (0.427\%)*
\\
\hline
Inhibitory,
&
8 transects
&
20 transects
&
40 transects
&
56 transects
\\
20\% Close Pairs
&
2 paired
&
5 paired
&
10 paired
&
14 paired
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.67\% (0.0444\%)*
&
6.56\% (0.157\%)*
&
12.8\% (0.303\%)*
&
17.6\% (0.368\%)*
\\
\hline
Serpentine,
&
7 transects
&
22 transects
&
47 transects
&
67 transects
\\
5 Zigzags
&
75 unit offset
&
23.9 unit offset
&
11.2 unit offset
&
7.84 unit offset
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.67\%
&
6.68\%
&
13.4\%
&
18.7\%
\\
\hline
Serpentine,
&
7 transects
&
22 transects
&
47 transects
&
67 transects
\\
8 Zigzags
&
42.9 unit offset
&
13.6 unit offset
&
6.38 unit offset
&
4.48 unit offset
\\
\hfill\emph{Distance:}
&
7000 units
&
17500 units
&
35000 units
&
49000 units
\\
\hfill\emph{\% Surveyed:}
&
2.67\%
&
6.67\%
&
13.3\%
&
18.7\%
\\
\hline
LHS-TSP
&
50 bins
&
300 bins
&
1200 bins
&
2400 bins
\\
\hfill\emph{Distance:}
&
7177 (189) units**
&
17191 (168) units**
&
34196 (225) units**
&
48433 (342) units**
\\
\hfill\emph{\% Surveyed:}
&
2.73\% (0.0722\%)**
&
6.51\% (0.0632\%)**
&
12.9\% (0.0835\%)**
&
18.2\% (0.127\%)**
\\
\hline
Hilbert Curve
&
3rd Order
&
4th Order
&
5th Order
&
6th Order
\\
\hfill\emph{Distance:}
&
8581 units
&
17442 units
&
35025 units
&
70121 units
\\
\hfill\emph{\% Surveyed:}
&
3.27\%
&
6.634\%
&
13.3\%
&
26.47\%
\\
\hline
\end{tabular}
\end{table}

The simulation uses each of the design schemes discussed in
Section~\ref{methodschemes}. The design parameters for each scheme are varied
to create four different levels of survey effort: low, medium, high, and very
high. Within each effort level, the total lengh or distance traveled is
comparable across all schemes. The inhibitory plus close pairs scheme and the
serpentine scheme are further varied to employ different numbers of pairs
and different numbers of zigzags, respectively. Table \ref{designtable}
provides an overview of the different settings.

The parallel transect schemes have 10, 25, 50, or 70 line transects running
north-south. We expect the simple random sample scheme to produce high
prediction variance and large prediction error in big gaps between transects.
The systematic sample scheme uses a uniformly-distributed starting point and
constant spacing between adjacent transects. We expect systematic transects to
provide low bias and moderate prediction variance. However, this scheme can
miss structures at certain sizes because no transects are close to each other
in the east-west direction.

For the inhibitory plus close pairs line transect scheme, we vary the numbers of
paired and unpaired transects. The total number of transects is 10, 25, 50, or
70, with 10\% and 20\% of the transects (rounded to the nearest integer) as
redundant members of a pair. The remaining primary transects are placed
according to a one-dimensional Strauss process \citep{strauss,kellyripley}. The
Strauss attraction parameter is set at \(\gamma = 0.05\) and the radius for
counting pairs is 1500 units divided by the total number of transects. Then
each redundant transect is randomly paired to a primary transect, and placed
within the pair radius of the primary transect according to a uniform
distribution. We expect this scheme to have intermediate performance between
the simple random sample and the systematic line transect schemes.

The serpentine transect scheme has 7, 22, 47, or 67 transects running
north-south with constant east-west spacing and a random starting point for the
first transect. The number of zigzags (north-south segments) is 5 or 8 per
transect, and the pedicular offest is set so the the total east-west
distance equals the length of three north-south line transects. Thus, the
serpentine designs traverse the same length as the line transect designs. These
designs should result in smaller prediction errors and lower variance farther
from the path, compared to line-transect designs.

Our Latin hypercube sampling/traveling salesperson (LHS-TSP) scheme uses 50,
300, 1200, or 2400 bins to generate the waypoints. Preliminary experimentation
found that these bin numbers produced total lengths similar to the
line-transect schemes. The LHS-TSP scheme is expected to result in small
prediction errors and low prediction variance per unit distance traveled.
However, the designs will have many sharp corners and may leave some large
voids.

The Hilbert curve scheme uses a random starting point and a Hilbert curve of
order 3, 4, 5, or 6. The path length is a deterministic function of the order
and differs greatly among curves of different orders. These orders yield
lengths similar to the lenths of the transect designs. Hilbert designs should
provide low prediction variance, but have lots of short segments.


\subsection{Model specification}

The same Bayesian LGCP model is fit to each observed dataset. The observed
point pattern \(\mathbf{x}\) is a realization of \(\mathbf{X}\), a Poisson
process on \(\mathcal{R}\) with intensity \(\lambda(u)\). The intensity is
modeled as \(\log[\lambda(u)] = \mu + \mathbf{e}(u)\). The spatial error term
\(\mathbf{e}\) is a Gaussian process with mean \(\mathbf{0}\) and a
Mat\'{e}rn covariance function with fixed \(\nu = 1\).
% Remember alpha = nu + d/2 so alpha = 2 and d = 2 imply nu = 1.

The intercept \(\mu\) has a \(\mathrm{Unif}(-\infty, \infty)\) prior.
% Or \(\mathrm{N}(0, \infty)\)?
The covariance parameters \(\sigma\) and \(\rho\) have a PC prior with
\(\mathrm{Pr}(\sigma > 3) = 0.1\) and \(\mathrm{Pr}(\rho < 100) = 0.1\)
\citep{fuglstadetal,simpsonpc}.

The Gaussian process prediction surface is approximated on the finite element
mesh shown in Figure~\ref{meshfull}. The GP is predicted at the nodes (points)
and is linearly interpolated elsewhere. The nodes are weighted according to
the area of their dual cells (shading) and used for numerical integration of
the likelihood \citep{lindgrenetal}.

\begin{figure}
\includegraphics[width=5in]{../graphics/mesh_full.pdf}
\caption{Illustration of the mesh and associated numerical integration
weighting scheme used to approximate the latent GP.}
\label{meshfull}
\end{figure}


%\section{Theory/calculation}
% A Theory section should extend, not repeat, the background to the article already dealt with in the Introduction and lay the foundation for further work. In contrast, a Calculation section represents a practical development from a theoretical basis.


\section{Results}
% Results should be clear and concise.

%look at examples of designs that minimize each criterion

%look at examples of designs along the Pareto front

%The results section will compare the distribution of prediction variance for
%the Gaussian process averaged over space (APV). We will focus on the average of
%APV for the 100 designs from each scheme applied to each dataset, but will
%point out and discuss if any schemes have large variance or skew in the
%distribution of APV. We will plot the relationships among APV, path length, and
%number of segments. The manuscript will focus on one LGCP dataset and one
%clustered dataset; the analysis of the other datasets will be in the
%supplemenatal materials. The supplemental materials will also include a repeat
%of this analysis for mean squared prediction error (MSPE). The conclusions of
%the MSPE analysis will probably be very similar to those of the APV analysis,
%but if there are any difference will will point them out in the main
%manuscript.

\subsection{Initial Observations}

In describing the results, we focus on one LGCP dataset and one LGCP with
Clusters dataset (Figure~\ref{fulldata}). The results are similar for all
datasets (see the online supplement.)

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-SRS000187-LGCP000004.pdf}
\caption{Predicted log-intensity}
\label{lambdasrs000187lgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambdaSD-SRS000187-LGCP000004.pdf}
\caption{Prediction SD}
\label{sdsrs000187lgcp}
\end{subfigure}

\caption{Predicted log-intensity function and prediction standard deviation
using data observed via a SRS of line transects. The SD is shown for each
finite element node. This example is a medium-effort plan applied to a
LGCP dataset.}
\label{srs000187lgcp}
\end{figure}

Figure~\ref{srs000187lgcp} shows an example where the model does well at predicting
the intensity of the realized LGCP from data observed along one of the SRS
paths. In the figure, the path appears in white and the observed events are
shown as white dots. The posterior predicted mean of the log-intensity (top
panel) accurately captures the large-scale features, but smooths out much of
the small-scale variation. The bottom panel shows the prediction standard
deviation for each mesh node. The SD ranges from 2.0 to 3.1, and is lowest
near observed events. SD increases farther from observed events, including
in places where the surveyed area was observed to contain no events.

This same survey plan also did well for the LGCP with Clusters dataset, with
the model accurately capturing the large-scale details of the intensitiy
function, including two of the circular hotspots corresponding to clusters
(Figure \ref{lambdasrs000187clust}). However, it also smoothed the surface
quite a bit, notably merging the two overlapping clusters into a single oblong
hotspot.

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-SRS000187-Cluster000004.pdf}
\caption{Predicted log-intensity}
\label{lambdasrs000187clust}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambdaSD-SRS000187-Cluster000004.pdf}
\caption{Prediction SD}
\label{sdsrs000187clust}
\end{subfigure}

\caption{Predicted log-intensity function and prediction standard deviation
using data observed via a SRS of line transects. The SD is shown for each
finite element node. This example is a medium-effort plan applied to a
LGCP with Clusters dataset.}
\label{srs000187clust}
\end{figure}

Most plans yielded similar prediction surfaces, capturing the large-scale
trends, and having the least uncertainty near observed events. Results varied
in accuracy at the most extreme peaks and valleys of the itensity function and
in overall SD across the study region.

However, a small number of model fits suffered from apparent edge effects.
For example, Figure~\ref{serp000148} shows the prediction surface resulting
from a serpentine transect plan. The predicted log-intensity has a hotspot of
extremely large values in the southeast corner (notice the color scale). The
hotspot is driven by two nodes on the boundary with very large prediction
values. Another, less extreme, edge effect is present in the northeast corner.

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-Serp000148-LGCP000004.pdf}
\caption{Predicted log-intensity. The color scale is truncated at 100, but
reaches a maximum of 692.}
\label{lambdaserp000148lgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambdaSD-Serp000148-LGCP000004.pdf}
\caption{Prediction SD}
\label{sdserp000148lgcp}
\end{subfigure}

\caption{Predicted GP surface and prediction SD using data observed via a
serpentine transect plan. The prediction has an apparent edge effect in the
southeastern corner. The SD is high across much of the site. This example is
a medium-effort plan applied to a LGCP dataset.}
\label{serp000148}
\end{figure}


\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/HighMSPE-LGCP000004.png}
\caption{MSPE distribution for one LGCP dataset}
\label{highmspelgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/HighMSPE-Cluster000004.png}
\caption{MSPE distribtuion for one LGCP with Clusters dataset}
\label{highmspecluster}
\end{subfigure}

\caption{Plots of the distribution of high and low mean squared prediction
error (MSPE) vs survey effort for each plan applied to one realization of a
LGCP and one realization of a LGCP with Clusters.}
\label{histmsperesults}
\end{figure}


\subsection{LGCP simulation results}

There are two important characteristics of a useful spatial prediction. First,
deviation from the true surface should be low, and is indicated by low
mean squared prediction error (MSPE). Second, the model's own assessment of
prediction uncertainty will be used in practice to build trust in the
inferences, so average prediction variance (APV) should be low.

Considered across all survey plans and prediction surfaces, both MSPE and APV
had right-skewed distributions. Thus we use logarithmic scales for plots and
summarize them using the median and interquartile range (IQR). Median MSPE
decreases with increasing path distance, leveling off between 20000 and 30000
units of distance for the LGCP data but continuing to decrease through 50000
units for the LGCP with Clusters data (Figure~\ref{lgcpresults}). Variability
(IQR) of MSPE also descreases as distance increases. Prediction surfaces with
edge effects form a cluster of large, outlying MSPE values. The lowest-MSPE
prediction surfaces result from the longest Hilbert designs. Overall, the
differences among the different schemes with respect to median MSPE are much
less than the variability in MSPE within each effort level.
% More specifically, this last sentance means there was "more" variation across
% realizations than with variations. No scheme was best or least variable for
% all realizations.

%The relationship between APV and MSPE differs from realization to realization
%(Figure~\ref{apvresults}). Surfaces in the high-MSPE cluster have high APV, but
%otherwise there is little association between APV and MSPE.
% Point out which did best anyways.

%\emph{Maybe omit fits with \(\mathrm{MSPE} > 100\) from other results?}

%\begin{itemize}
%\item LHS-TSP has lowest median APV for paths under 10000 units but large IQR
%\item For longer paths, SRS isn't bad
%\item SRS has slightly lower median and IQR of APV than systematic
%\item The longest serp designs with 5 zigzags have lowest IQR of MSPE and APV
%\item Inhib has high variability for clustered data
%\item Lowest MSPE designs were Hilbert order 6
%\end{itemize}

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/MSPE-effort-LGCP000004.png}
\caption{MSPE vs survey effort for one LGCP dataset}
\label{mspelgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/APV-effort-LGCP000004.png}
\caption{APV vs survey effort for one LGCP dataset}
\label{apvlgcp}
\end{subfigure}

\caption{Plots of mean squared prediction error (MSPE) and average prediction
variance (APV) vs survey effort for each plan applied to one realization of a
LGCP. Line segments connect the median at each effort level. The plots are
paneled by design scheme.}
\label{lgcpresults}
\end{figure}

%\begin{figure}
%
%\begin{subfigure}{5in}
%\includegraphics[width=5in]{../graphics/APV-MSPE-LGCP000004.png}
%\caption{APV vs MSPE for one LGCP dataset}
%\label{apvlgcp}
%\end{subfigure}
%
%\begin{subfigure}{5in}
%\includegraphics[width=5in]{../graphics/APV-MSPE-Cluster000004.png}
%\caption{APV vs MSPE for one LGCP with Clusters dataset}
%\label{apvcluster}
%\end{subfigure}
%
%\caption{Plots of average prediction variance (APV) vs MSPE for each plan
%applied to one realization of a LGCP and one realization of a LGCP with a
%Clusters.}
%\label{apvresults}
%\end{figure}


\subsection{LGCP with Clusters simulation results}

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/MSPE-effort-Cluster000004.png}
\caption{MSPE vs survey effort for one LGCP with Clusters dataset}
\label{mspeclust}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/APV-effort-Cluster000004.png}
\caption{APV vs survey effort for one LGCP with Clusters dataset}
\label{apvclust}
\end{subfigure}

\caption{Plots of mean squared prediction error (MSPE) and average prediction
variance (APV) vs survey effort for each plan applied to one LGCP with Clusters
dataset. Line segments connect the median at each effort level. The plots are
paneled by design scheme.}
\label{clustresults}
\end{figure}


\subsection{Augmenting a poor-performing design}

Even a poor-performing design could be used as a starting point for sequential
design. As a simple illustration, we augment the design from
Figure~\ref{serp000148} with some additional sampling effort in the eastern
part of the site, where the edge effects were seen in the prediction surface.
The total distance surveyed increases from 17500 to 20180 units, while the
predicted log-intensity surface is much more accurate (Figure~\ref{aug}).
MSPE decreases from 1600.57 to 2.48 and APV improves from 67.20 to 11.02.
Across the site, the prediction standard deviation is lower than before, and
is now highest around the edge of the western half. If we were to continue
adding segments to the path, giving some attention to the western portion of
the site could further improve the prediction.


\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-Aug-LGCP000004.pdf}
\caption{Predicted log-intensity}
\label{lambdaaug}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambdaSD-Aug-LGCP000004.pdf}
\caption{Prediction SD}
\label{sdaug}
\end{subfigure}

\caption{Predicted log-intensity function and prediction standard deviation
using data observed via a serpentine transect design augmented post-hoc. The
SD is shown for each finite element node.}
\label{aug}
\end{figure}


\subsection{Spatial coverage}

While the above results suggest the choice of design is relatively unimportant
and the distance traveled is the main driver of the quality of the spatial
predictions, it is important to consider that all of the design schemes ensure
the path is distributed across the entire study region. Designs that leave
large unexplored voids will not perform as well.

As an example, Figure~\ref{badxsect} shows the results of using a systematic
sample of 50 parallel transects in the western 20\% of the study site. This
design traverses a distance of 35000 units but leaves most of the site far from
the observed path. As a result, the predicted log-intensity is flat near the
GP posterior mean of \(-8.71\) over most of the site, rendering the prediction
mostly useless.

\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambda-BadXsect-LGCP000004.pdf}
\caption{Predicted log-intensity}
\label{lambdabad}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/lambdaSD-BadXsect-LGCP000004.pdf}
\caption{Prediction SD}
\label{sdbad}
\end{subfigure}

\caption{Predicted log-intensity function and prediction standard deviation
using data observed via a systematic sample of a small section of the site. The
SD is shown for each finite element node.}
\label{badxsect}
\end{figure}


\begin{figure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/MSPE-Coverage-LGCP000004.png}
\caption{MSPE vs coverage for one LGCP dataset}
\label{covglgcp}
\end{subfigure}

\begin{subfigure}{5in}
\includegraphics[width=5in]{../graphics/MSPE-Coverage-Cluster000004.png}
\caption{MSPE vs coverage for one LGCP with Clusters dataset}
\label{covgclust}
\end{subfigure}

\caption{MSPE plotted against the maximum distance from any point in the site
to its the nearest point on the path. As survey effort increases, the cloud of
points drifts down (lower MSPE) and to the left (lower minimax distance to the
path).}
\label{covg}
\end{figure}

% Further things to plot:
% MSPE vs number of segments - Decreasing variability, no improvement after some point.
% MSPE vs average distance from path - linear relationship, varies by realization.
% Neither has a relationship with APV.


\section{Discussion}
% This should explore the significance of the results of the work, not repeat them. A combined Results and Discussion section is often appropriate. Avoid extensive citations and discussion of published literature.

\begin{itemize}
\item increasing uncertainty along path --- reasonable, path is narrow, could
be events just out of detection range

\item convergence problems/large variance solution is more data collection?

\item discuss starting points for optimization and sequential design

\item practical issue: path will be smoothed, no instantaneous direction
changes at corners, equipment may have limitations which is why we looked at
number and distribution or turn angles

\item could incorporate turns into loss function or use multi-objective
optimization~\citep{lark}
\end{itemize}


\section{Conclusions}
% The main conclusions of the study may be presented in a short Conclusions section, which may stand alone or form a subsection of a Discussion or Results and Discussion section.

\begin{itemize}
\item for accuracy, choice of scheme does not matter much as long as it provides
spatial coverage

\item of the schemes considered here, only transect schemes have flexiblility
in distance and/or a priori known distance

\item corners and regularity important for short paths to avoid model fitting
problems (Hilbert or serpentine)

\item systematic line-transects provide best spatial coverage but require many
transects for good model performance

\item tradeoff useable posterior and simple designs
\end{itemize}


%\appendix
%\section{Notation and Terminology}

%\begin{itemize}

%\item process defined on \(\mathcal{D} \subset \mathbb{R}^{d}\), domain of the
%intensity function, in this manuscript \(d = 2\)

%\item observation window \(\mathcal{S} \subset \mathcal{D}\)

%\item define three regions:
%\begin{itemize}
%\item the domain \(\mathcal{D}\) over which the process mathematically operates
%\item the study region \(\mathcal{R}\) over which inferences are desired
%\item the observed/sampled observation window \(\mathcal{S}\)
%\end{itemize}

%\item general relationship is \(\mathcal{S} \subset \mathcal{R}
%\subset \mathcal{D} \subset \mathbb{R}^{d}\) where all of the subset symbols
%taken to mean ``subset or equal''

%\item \(\mathcal{D}\) can be bounded or unbounded (often equal to
%\(\mathbb{R}^{d}\)), $\mathcal{S}$ practically always bounded, \(\mathcal{R}\)
%bounded or unbounded depending on application and inferential goals

%\item the ``fully surveyed'' (censused) situation is
%\(\mathcal{S} = \mathcal{R}\)

%\item survey path \(\mathcal{P}\) is a one-dimensional subset of
%\(\mathcal{R}\)
%\begin{itemize}
%\item set of one or more sequences of waypoints connected by line segments
%\item \(\mathcal{S}\) is the set of all points within a fixed (and assumed
%known) radius of \(\mathcal{P}\)
%\end{itemize}

%\item \(\mathbf{X}\) point process on \(\mathcal{R}\), \(\mathbf{x} = \{x_{1},
%\dots, x_{n}\}\) realized point pattern
%\begin{itemize}
%\item \(\mathbf{X}_{\mathcal{S}} = \mathbf{X} \cap \mathcal{S}\) the
% restriction of \(\mathbf{X}\) to \(\mathcal{S}\), \(\mathbf{x} = \mathbf{X}
%\cap \mathcal{S}\) the realized observeable point pattern
%\end{itemize}

%\item point \(x \in \mathbf{x}\) called an event

%\item intensity function \(\lambda(u)\)

%\item types of ``points'' in space:
%\begin{itemize}
%\item \(x\) event in the point pattern
%\item \(s\) numerical integration node
%\item \(u\) arbitrary location in \(\mathcal{D}\) used to index intensity
%function and predictors
%\end{itemize}

%\item \(z(u)\) a column vector of covariates/predictors at \(u\) (not used in
%this manuscript)

%\item ``point'' refers to a \(u\) unless clearly stated otherwise

%\item bold for sets and spatial processes, normal italics for spatial vectors

%\item \(y\) and variations will be used for objects derived from the point
%pattern, e.g. marks, pseudodata

%\item distance sampling fits into the framework with expansion of notation
%to include a (nontrivial) detection function and differentiate between the
%observed and observable point patterns

%\end{itemize}


%\section{Extension of Nearest Neighbor Distance to Paths}


\section*{References}

\bibliography{lgcp_sampling.bib}

\end{document}
