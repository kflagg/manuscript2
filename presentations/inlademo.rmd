---
title: "INLA Demonstration"
author: "Kenneth A. Flagg"
bibliography: "../references.bib"
output:
  revealjs::revealjs_presentation:
    fig_height: 6
    fig_width: 10
    fig_crop: FALSE
    height: "960px"
    width: "720px"
    theme: "black"
    slide_level: 2
    transition: "slide"
    incremental: TRUE
    self_contained: TRUE
---


```{r setup, cache=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(cache=TRUE, echo=FALSE, warning=FALSE, message=FALSE,
  fig.width=10, fig.height=6, dpi=150, fig.align='center',
  dev.args=list(family='sans', pointsize=21))

library(spatstat)
library(INLA)
library(inlabru)
library(maptools)
```

# Introduction

## Why INLA?

- Bayesian Hierarchical models
     - Many latent Gaussian variables
     - Few parameters
- Monte Carlo methods impractical
 - Approximate posterior marginals using Laplace expansions
     - Clever algebra, end up with posterior in denominator
     - Taylor expand posterior about its mode
     - Results in a Gaussian approximation
     - Some numerical integration needed

## Advantages and Disadvantages

 - Advantages
    - Accurate approximation
    - Fast computation of many posterior marginals
 - Disadvantages
    - Does not provide full joint posterior
    - Slow with >4-6 parameters


## Derivations

From @rinla, Section 4.7

Include derivations of $\tilde{p}(\boldsymbol{\psi}|\mathbf{y})$, $\tilde{p}(\theta_{i}|\boldsymbol{\psi},\mathbf{y})$, and $\tilde{p}(\theta_{i}|\mathbf{y})$; and explanations of mode-finding and CCD.


# Illustrations

## Simple Normal Example

@rinla section 4.9


## Spatial Point Pattern: Trees in a Rainforest

```{r beiplot}
plot(bei, asp = 1)
```

```{r beilgcp}
bei_df <- as.SpatialPoints.ppp(bei)
# Need mesh and prior for GP.
#bei_lgcp <- lgcp(, data = bei_df)
```

# References

## References

